{% extends "base.html.twig" %}
{% set valid_date = "" %}
{% set new = 1 %}

{% block title %}
    {{ '%entity% list'|trans({'%entity%': 'title'|trans({}, 'gs_inventories')}, 'admin') }} - {{ parent() }}
{% endblock %}

{% block body_title %}
    <i class="fa fa-barcode" aria-hidden="true"></i>
    {{ '%entity% list'|trans({'%entity%': 'title_short'|trans({}, 'gs_inventories')}, 'admin') }}
{% endblock %}

{% block glstock_body %}
    <div class="panel panel-default">
        <header class="panel-heading"><i class="glyphicon glyphicon-list"></i> {{ 'journals.title'|trans({}, 'gs_inventories') }}</header>
        <table class="table table-striped table-hover records_list">
            <thead>
                <tr>
                    <th scope="col" class="col-md-1">{{ 'gestock.id'|trans }}</th>
                    <th scope="col" class="col-md-2">
                        <i class="fa fa-calendar"></i> 
                        {{ 'gestock.date'|trans }}
                    </th>
                    <th scope="col" class="col-md-3">{{ 'gestock.amount'|trans }}</th>
                    <th scope="col" class="col-md-2">{{ 'settings.status'|trans({}, 'gs_inventories') }}</th>
                    <th scope="col" class="col-md-4 text-center">
                        <i class="fa fa-hourglass-o"></i> 
                        {{ 'Actions'|trans({}, 'admin') }}
                    </th>
                </tr>
            </thead>
            <tbody>
                {% for inventory in paginator %}
                    <tr>
                        <td>{{ inventory.id }}</td>
                        <td>{% if inventory.date %}
                            <a href="{{ path('inventory_show', {id: inventory.id}) }}">
                                {{ inventory.date|date('d/m/Y') }}
                            </a>
                        {% endif %}</td>
                        <td>{{ inventory.amount }} â‚¬</td>
                        {% if inventory.status == 1 or inventory.status == 2 %}
                            <td class="text-info">{{ 'settings.in_progress'|trans({}, 'gs_inventories') }}</td>
                        {% elseif inventory.status == 3 %}
                            <td class="text-success">{{ 'settings.closed'|trans({}, 'gs_inventories') }}</td>
                        {% endif %}
                        <td class="text-center">
                            <div class="btn-group">
                                <a class="btn btn-default btn-show btn-xs" href="{{ path('inventory_show', {id: inventory.id}) }}">
                                    {{ 'show'|trans({}, 'admin') }}
                                </a>
                                    {% if inventory.status == 2 or inventory.status == 1 and is_granted('ROLE_ADMIN') %}{% set new = 0 %}
                                <a class="btn btn-info btn-edit btn-xs" href="{{ path('inventory_edit', {id: inventory.id}) }}">
                                    {{ 'seizure.title_short'|trans({}, 'gs_inventories') }}
                                </a>
                                <a class="btn btn-success btn-xs" href="{{ path('inventory_valid', {id: inventory.id}) }}">
                                    <i class="fa fa-check"></i>{{ 'close.submit_button'|trans({}, 'gs_inventories') }}
                                </a>
                                {% endif %}
                            </div>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="text-center">{{ knp_pagination_render(paginator) }}</div>
    
    <div class="btn-group">
        {% include 'homeButton.html.twig' %}
        {% if is_granted('ROLE_ADMIN') and new == 1 %}
        <button class="btn btn-info btn-create" type="button" data-toggle="modal" data-target="#create_confirm">
            {{ 'Create a new entry'|trans({}, 'admin') }}
        </button>
        {% endif %}
    </div>

    {% if is_granted('ROLE_ADMIN') %}
        {% include 'AppBundle:inventory:createform.html.twig' %}
    {% endif %}
{% endblock %}
