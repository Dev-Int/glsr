{% extends "base.html.twig" %}
{% set valid_date = "" %}
{% set new = 1 %}

{% block title %}
    {{ '%entity% list'|trans({'%entity%': 'title'|trans({}, 'gs_inventories')}, 'admin') }} - {{ parent() }}
{% endblock %}

{% block body_title %}
    <i class="fa fa-tasks" aria-hidden="true"></i>
    {{ '%entity% list'|trans({'%entity%': 'title_short'|trans({}, 'gs_inventories')}, 'admin') }}
{% endblock %}

{% block glstock_body %}
    <div class="panel panel-default">
        <header class="panel-heading"><span class="glyphicon glyphicon-list" aria-hidden="true"></span> {{ 'journals.title'|trans({}, 'gs_inventories') }}</header>
        <table class="table table-striped table-hover records_list">
            <thead>
                <tr>
                    <th scope="col" class="col-md-1 text-center">{{ 'gestock.id'|trans }}</th>
                    <th scope="col" class="col-md-2 text-center">
                        <i class="fa fa-calendar" aria-hidden="true"></i> 
                        {{ 'gestock.date'|trans }}
                    </th>
                    <th scope="col" class="col-md-3 text-center">
                        <i class="fa fa-money" aria-hidden="true"></i> 
                        {{ 'gestock.amount'|trans }}
                    </th>
                    <th scope="col" class="col-md-2 text-center">
                        <i class="fa fa-leaf" aria-hidden="true"></i>
                        {{ 'settings.status'|trans({}, 'gs_inventories') }}
                    </th>
                    <th scope="col" class="col-md-4 text-center">
                        <i class="fa fa-hourglass-o" aria-hidden="true"></i> 
                        {{ 'Actions'|trans({}, 'admin') }}
                    </th>
                </tr>
            </thead>
            <tbody>
                {% if paginator.items is empty %}
                    <tr>
                        <td colspan="7" class="text-center">
                            <h2>{{ 'none'|trans({}, 'gs_inventories') }}</h2>
                        </td>
                    </tr>
                {% else %}
                {% for inventory in paginator %}
                    <tr>
                        <td class="text-right">{{ inventory.id }}</td>
                        <td class="text-center">{% if inventory.date %}
                            <a href="{{ path('inventory_show', {id: inventory.id}) }}">
                                {{ inventory.date|date('d/m/Y') }}
                            </a>
                        {% endif %}</td>
                        <td class="text-right">{{ inventory.amount|localizedcurrency('EUR') }}</td>
                        {% if inventory.status == 1 or inventory.status == 2 %}
                            <td class="text-info text-center">{{ 'settings.in_progress'|trans({}, 'gs_inventories') }}</td>
                        {% elseif inventory.status == 3 %}
                            <td class="text-success text-center">{{ 'settings.closed'|trans({}, 'gs_inventories') }}</td>
                        {% endif %}
                        <td class="text-center">
                            <div class="btn-group">
                                <a class="btn btn-default btn-show btn-xs" href="{{ path('inventory_show', {id: inventory.id}) }}">
                                    {{ 'show'|trans({}, 'admin') }}
                                </a>
                                    {% if inventory.status == 2 or inventory.status == 1 and is_granted('ROLE_ADMIN') %}{% set new = 0 %}
                                <a class="btn btn-info btn-edit btn-xs" href="{{ path('inventory_edit', {id: inventory.id}) }}">
                                    {{ 'seizure.title_short'|trans({}, 'gs_inventories') }}
                                </a>
                                <a class="btn btn-success btn-xs" href="{{ path('inventory_valid', {id: inventory.id}) }}">
                                    <i class="fa fa-check" aria-hidden="true"></i>{{ 'close.submit_button'|trans({}, 'gs_inventories') }}
                                </a>
                                {% endif %}
                            </div>
                        </td>
                    </tr>
                {% endfor %}
                {% endif %}
            </tbody>
        </table>
    </div>

    <div class="text-center">{{ knp_pagination_render(paginator) }}</div>
    
    <div class="btn-group">
        {% include 'homeButton.html.twig' %}
        {% if is_granted('ROLE_ADMIN') and new == 1 %}
        <button class="btn btn-info btn-create" type="button" data-toggle="modal" data-target="#create_confirm">
            {{ 'Create a new entry'|trans({}, 'admin') }}
        </button>
        {% endif %}
    </div>

    {% if is_granted('ROLE_ADMIN') %}
        {% include 'AppBundle:Stocks/Inventory:createform.html.twig' %}
    {% endif %}
{% endblock %}
